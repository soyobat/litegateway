<?xml version="1.0" encoding="UTF-8"?>
<!DOCTYPE mapper PUBLIC "-//mybatis.org//DTD Mapper 3.0//EN" "http://mybatis.org/dtd/mybatis-3-mapper.dtd">
<mapper namespace="com.grace.gateway.admin.mapper.GatewayConfigMapper">

    <!-- 分页查询网关配置列表 -->
    <select id="selectPageByQuery" resultType="com.grace.gateway.admin.entity.GatewayConfigEntity">
        SELECT
            id, name, description, gateway_name, gateway_port, config_center_type, config_center_address,
            nacos_namespace, nacos_group, nacos_data_id, register_center_type, register_center_address,
            routes_config, status, create_time, update_time, create_by, update_by, is_deleted
        FROM
            gateway_config
        WHERE
            is_deleted = 0
            <if test="query.name != null and query.name != ''">
                AND name LIKE CONCAT('%', #{query.name}, '%')
            </if>
            <if test="query.gatewayName != null and query.gatewayName != ''">
                AND gateway_name LIKE CONCAT('%', #{query.gatewayName}, '%')
            </if>
            <if test="query.configCenterType != null and query.configCenterType != ''">
                AND config_center_type = #{query.configCenterType}
            </if>
            <if test="query.registerCenterType != null and query.registerCenterType != ''">
                AND register_center_type = #{query.registerCenterType}
            </if>
            <if test="query.status != null">
                AND status = #{query.status}
            </if>
        ORDER BY
            update_time DESC
    </select>

    <!-- 根据ID查询网关配置 -->
    <select id="selectById" resultType="com.grace.gateway.admin.entity.GatewayConfigEntity">
        SELECT
            id, name, description, gateway_name, gateway_port, config_center_type, config_center_address,
            nacos_namespace, nacos_group, nacos_data_id, register_center_type, register_center_address,
            routes_config, status, create_time, update_time, create_by, update_by, is_deleted
        FROM
            gateway_config
        WHERE
            id = #{id}
            AND is_deleted = 0
    </select>

    <!-- 根据网关名称查询配置 -->
    <select id="selectByGatewayName" resultType="com.grace.gateway.admin.entity.GatewayConfigEntity">
        SELECT
            id, name, description, gateway_name, gateway_port, config_center_type, config_center_address,
            nacos_namespace, nacos_group, nacos_data_id, register_center_type, register_center_address,
            routes_config, status, create_time, update_time, create_by, update_by, is_deleted
        FROM
            gateway_config
        WHERE
            gateway_name = #{gatewayName}
            AND is_deleted = 0
    </select>
    <select id="selectAllEnabled" resultType="com.grace.gateway.admin.entity.GatewayConfigEntity">

    </select>

</mapper>
